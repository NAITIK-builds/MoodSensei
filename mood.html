<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mood Detection</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Mood Detection Zone</h1>
  <video id="video" width="320" height="240" autoplay></video>
  <p id="status">Detecting your mood...</p>
  <button onclick="detectMood()">Check Mood</button>

  <script src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
  <script>
    const video = document.getElementById('video');
    const statusText = document.getElementById('status');

    // Start webcam
    async function startVideo() {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      video.srcObject = stream;
    }

    // Load face API models
    Promise.all([
      faceapi.nets.tinyFaceDetector.loadFromUri('/models'),
      faceapi.nets.faceExpressionNet.loadFromUri('/models')
    ]).then(startVideo);

    async function detectMood() {
      const detections = await faceapi.detectSingleFace(video, new faceapi.TinyFaceDetectorOptions()).withFaceExpressions();
      
      if (detections && detections.expressions) {
        const exp = detections.expressions;
        const mood = Object.keys(exp).reduce((a, b) => exp[a] > exp[b] ? a : b);

        statusText.innerText = `Detected mood: ${mood}`;

        if (mood === "happy") {
          alert("You're happy! You may proceed.");
        } else {
          alert("You seem sad. Redirecting you to game zone...");
          window.location.href = "https://www.crazygames.com"; // Replace with your fun zone
        }
      } else {
        statusText.innerText = "No face detected!";
      }
    }
  </script>
</body>
</html>
